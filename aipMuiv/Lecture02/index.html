<html>
<style>
    .code pre { font-family: monospace; }
    .hidden { color: white; }
    .red { color: red; }
    .define { font-size: 120%; color: red; }
    .definition { border: 1px solid red; padding:5px; }
    .inline { display: inline-block; }
    .in-border { display: inline-block; border: 1px solid black; padding:5px; }
</style>
<body>
<h1>Материалы курса Алгоритмизации и Программирования</h1>
<cite>Преображенский М.В. 2021/22</cite>
<h2>Лекция 3 - Значения, форматы и операторы</h2>
<p>На этой лекции мы разберёмся с тем, как именно работают переменные в Python и какое отношение это имеет к реальности.</p>
<h3>Где и как существуют переменные?</h3>
<p>На картинке ниже представлено устройство компьютера. Как Вы думаете, где именно хранятся переменные значения программы?</p>
<img src="./cpuInside.jpg" />
<p><b>Ответ (выделить):</b> <span class="hidden">Оперативная память</span></p>
<p>В зависимости от носителя, значения в памяти могут храниться в разной форме:</p>
<p><img class="inline" src="./cd.jpg"/><img class="inline" src="./ssd.jpg"/></p>
<p>В оперативной памяти значения хранятся в виде электрических сигналов и существуют только пока им подаётся электрический ток. Прекращение подачи тока "гасит" значения.</p>
<p><B>ВАЖНО:</B> Обратите внимание, что на таком низком уровне нигде нет физических 0 или 1. Их и нигде не может быть - числа 0 и 1 не являются физическими телами, это существующие в наших головах идеи. Мы смотрим на физическое состояние носителя в конкретном физическом секторе памяти и определяем его как цифру 0 или цифру 1.</p>
<p>Таким образом, мы считаем что в оперативной памяти компьютера хранятся значения нулей и единиц.</p>
<h3>Форматы: от значений памяти к формату целых чисел.</h3>
<p>В прошлом разделе мы поняли, что в памяти компьютера хранятся значения, но так же что в действительности эти значения - всего лишь следствие нашей договорённости о том, как именно мы интерпретируем конкретные физические измерения.</p>
<p>Договорившись о том, как читать отдельные 0 и 1, программисты и компьютерные инженеры начали дальше договариваться о том, как читать группы 0 и 1. Так появились первые <b>форматы данных</b></p>
<p>Первой такой договорённостью стало использование 0 и 1 компьютера как цифр двоичной записи числа. Этот формат получил название <b>BIN</b> (от слова binary).<br>\
    Одновременно с BIN родился формат <b>DEC</b> (decimal), представляющий соответствующее двоичному коду десятичное число.<br>
    Почти тут же возник формат HEX, в котором 4 соседних бита объединяются в 1 символ и получается шестнадцатеричное число.</p>
<p>Примеры записи нескольких чисел в разных форматах приведены ниже:</p>
<pre>DEC	BIN		HEX		DEC	BIN		HEX<br>
 1:	0b1      :	0x1 ;		 2:	0b10     :	0x2 ;<br>
 3:	0b11     :	0x3 ;		 4:	0b100    :	0x4 ;<br>
 5:	0b101    :	0x5 ;		 6:	0b110    :	0x6 ;<br>
 7:	0b111    :	0x7 ;		 8:	0b1000   :	0x8 ;<br>
 9:	0b1001   :	0x9 ;		10:	0b1010   :	0xa ;<br>
11:	0b1011   :	0xb ;		12:	0b1100   :	0xc ;<br>
13:	0b1101   :	0xd ;		14:	0b1110   :	0xe ;<br>
15:	0b1111   :	0xf ;		16:	0b10000  :	0x10;<br>
17:	0b10001  :	0x11;		18:	0b10010  :	0x12;<br>
19:	0b10011  :	0x13;		20:	0b10100  :	0x14;<br>
21:	0b10101  :	0x15;		22:	0b10110  :	0x16;<br>
23:	0b10111  :	0x17;		24:	0b11000  :	0x18;<br>
25:	0b11001  :	0x19;		26:	0b11010  :	0x1a;<br>
27:	0b11011  :	0x1b;		28:	0b11100  :	0x1c;<br>
29:	0b11101  :	0x1d;		30:	0b11110  :	0x1e;<br>
31:	0b11111  :	0x1f;		32:	0b100000 :	0x20;<br>
33:	0b100001 :	0x21;		34:	0b100010 :	0x22;</pre>
<cite>Сгенерировано этим кодом на python:</cite>
<pre class="code in-border">print(f'DEC\tBIN\t\t\tHEX\t\t\tDEC\tBIN\t\t\tHEX')
for i in range(1, 34, 2):
    print(f'{i:>2}:\t{bin(i):9}:\t{hex(i):4};\t\t{i+1:>2}:\t{bin(i+1):9}:\t{hex(i+1):4};')</pre>
<p>Таким образом, компьютер научился представлять целые числа. В большинстве современных языков программирования, включая Python, целочисленный формат обозначается как <b>int</b> (от слова integer).</p>
<p><span class="inline definition"><b class="define">int</b> - тип данных в языке Python, соответствующий целым числам.<br>
    Операция <b class="define">bin</b> возвращает строку с двоичной записью числа. Пример: <span class="code">bin(5)</span> вернёт "0b101".<br>
    Операция <b class="define">hex</b> возвращает строку с шестнадцатеричной записью числа. Пример: <span class="code">hex(26)</span> вернёт "0x1A".<br></span></p>
<p>Стоит отметить, что обычно размер целого числа ограничен количеством выделяемых под него битов памяти. В языках семейства C или в Java количество бит указывается явно. Питон сам разбирается с количеством бит и не ограничивает максимальное значение (жертвуя производительностью).</p>
<p>Так же стоит отметить, что обычно первый бит целого числа используют, чтобы показать его знак: 1 если число положительное, 0 если отрицательное.</p>
<h3>Форматы: от целых чисел к дробным.</h3>
<p>Научившись представлять в компьютере целочисленный формат, программисты захотели продвинуться дальше и сделать дробный формат.</p>
<p>Так как для компьютеров было естественно делать вычисления по принципу "в столбик" (то есть поразрядные вычисления с переносом значений между разрядами), то для деления тоже был выбран удобный для вычислений в столбик формат чисел: числа с плавающей точкой.</p>
<p>Число с плавающей точкой задаётся двумя целыми числами: <b>мантиссой</b>, содержащей число без точки и <b>порядком</b>, определяющим место точки. Ниже приведён пример использования мантиссы для десятичного числа:</p>
<pre>Мантисса	Порядок
		-3		-2		-1		0		1		2		3
256346		256.346		2563.46		25634.6		256346.0	2563460.0	25634600.0	256346000.0</pre>
<cite>Сгенерировано этим кодом на python:</cite>
<pre class="code in-border">print(f'Мантисса\tПорядок\n\t\t\t', end='')
for i in range(-3, 4):
    print(f'{i}\t\t\t', end='')
mantissa = 256346
print(f'\n{mantissa}\t\t', end='')
mantissa = mantissa / 1000
for i in range(-3, 4):
    print(f'{mantissa:<12}', end='')
    mantissa *= 10
</pre>
<p><b>ВАЖНО:</b> Внутри компьютера используется <b>Двоичная мантисса</b>. То есть используется двоичное число и двоичные разряды после точки.</p>
<p>Например, вот так будет представлено число 5.75:</p>
<pre style="code">5.75 = 1 * 4   + 0 * 2   + 1 * 1   + 1 * 0.5    + 1 * 0.25 =
       1 * 2^2 + 0 * 2^1 + 1 * 2^0 + 1 * 2^(-1) + 1 * 2^(-2) = 0b101.11</pre></p>
<p>Таким образом, из двух целых чисел получается число с плавающей точкой. По-английски "плавающий" - <b>float</b></p>
<p><span class="inline definition"><b class="define">float</b> - тип данных в языке Python, соответствующий дробным числам.</span></p>
<p>Стоит отметить, что использование <b>float</b> сопряжено с неточностями. Например, невозможно точно представить в двоичном формате <b>float</b> значение 1/3. Алгоритмы округления помогают, но не решают проблему целиком. Поэтому в системах требующих высокой точности всё равно приходится писать поддержку полноценных дробей.</p>
<h3>Форматы: от целых чисел к строкам.</h3>
<p>Первой крупной "коммерческой" (то есть по-настоящему оплачиваемой) задачей, которую решали компьютеры, было шифрование. То есть требовалось представлять не только числа, но и строки текста.</p>
<p>Научившись представлять числа, создатели компьютеров решили поставить каждому печатному символу в точное соответствие одно число. Получились кодовые таблицы. Примеры кодовых таблиц:</p>
<ul><li>Таблица ASCII, которая широко использовалась в 90е: <a href="https://www.industrialnets.ru/files/misc/ascii.pdf">ссылка на PDF</a></li>
    <li>Современная таблица Unicode: <a href="https://unicode-table.com/ru/#basic-latin">ссылка</a></li></ul>
<p>Таким образом, любая строка может быть представлена как последовательность числовых кодов:</p>
<pre>Символы:	'л'  	'ю'  	'б'  	'а'  	'я'  	' '  	'с'  	'т'  	'р'  	'о'  	'к'  	'а'
Коды (unicode):	'1083'	'1102'	'1073'	'1072'	'1103'	'32'	'1089'	'1090'	'1088'	'1086'	'1082'	'1072'</pre>
<cite>Сгенерировано этим кодом на python:</cite>
<pre class="code in-border">line = 'любая строка'

print("Символы:\t", end='')
formatter = "'{}'"
for symbol in line:
    print(f"\t{formatter.format(symbol):5}", end='')

print("\nКоды:\t\t", end='')
for symbol in line:
    print(f"\t'{ord(symbol)}'", end='')</pre>
<p>Строки оказались очень удобным типом данных, с которым можно делать много интересных операций. Поэтому они представлены во всех языках программирования как <b>string</b>(строка) или <b>str</b></p>
<p><span class="inline definition"><b class="define">str</b> - тип данных в языке Python, соответствующий строкам.<br>
    Можно получить любой символ строки по индексу в квадратных скобках (первый символ - 0). Пример: <span class="code">"Привет"[2]</span> вернёт "и".<br>
    Любой символ можно преобразовать в число операцией <b class="define">ord</b>. Пример: <span class="code">ord(' ')</span> вернёт 32.<br>
    Числа можно преобразовывать в символы операцией <b class="define">chr</b>. Пример: <span class="code">chr(32)</span> вернёт <span class="code">' '</span> - строку, в которой только пробел.<br>
</span></p>
<h3>Форматы: булевы значения.</h3>
<p>Булево значение может принимать только одно из двух значений - <b>True</b> (Истина) или <b>False</b> (Ложь). Эти значения соответствуют одному биту данных (1 или 0) и используются в разного рода условных операторах.</p>
<p>Подробнее о булевых значениях в лекции про условные операции.</p>
<p><span class="inline definition"><b class="define">bool</b> - тип данных в языке Python, соответствующий булевым значениям.</span></p>
<h3>Форматы: итоги.</h3>
<p>Вы познакомились с основными форматами данных в Питоне:</p>
<ul><li><b class="define">int</b> - целые числа.</li>
    <li><b class="define">float</b> - дробные числа.</li>
    <li><b class="define">str</b> - строки.</li>
    <li><b class="define">bool</b> - булевы значения.</li>
</ul>
<p>Вы узнали как эти форматы устроены и как они соотносятся с битами в памяти компьютера.</p>
<h3>Преобразования форматов.</h3>
<p>В языке программирования Python можно так же преобразовывать разнообразные форматы между собой. Для этого название формата используется как операция со скобками. Несколько примеров:</p>
<ul><li><span class="code">str(52)</span> даст строку <span class="code">"52"</span></li>
    <li><span class="code">int("52")</span> даст число 52</li>
    <li><span class="code">int(3.5)</span> отбросит целую часть и даст целое число 3</li>
    <li><span class="code">int(-2.98)</span> отбросит целую часть и даст целое число -2</li>
    <li><span class="code">float(3)</span> даст число 3.0 с типом данных <b>float</b></li>
    <li><span class="code">str(23.845)</span> даст строку <span class="code">"23.845"</span></li>
    <li><span class="code">float("23.845")</span> даст число 23.845</li>
    <li><span class="code">bool(0)</span> даст False, а от любого другого числа - True</li>
    <li><span class="code">bool("")</span> (то есть от пустой строки) даст False, а от любой другой строки - True</li>
    <li><span class="code">str(True)</span> даст строку <span class="code">True</span>(аналогично с False)</li>
</ul>
<p>Преобразования из строк в числа могут давать ошибки, если в строке не число:</p>
<ul><li><span class="code">float("abc")</span> даст ошибку, потому что не поймёт символ 'a'.</li>
    <li><span class="code">int("0b001")</span> даст ошибку, потому что не поймёт символ 'b'.</li>
    <li><span class="code">int("3.5")</span> даст ошибку, потому что в целом числе запрещены точки.</li>
    <li><span class="code">float("3,5")</span> даст ошибку, потому что в Python дробная часть отделяется точкой, а не запятой.</li>
    <li><span class="code">float(3)</span> даст число 3.0 с типом данных <b>float</b></li>
    <li><span class="code">str(23.845)</span> даст строку <span class="code">"23.845"</span></li>
    <li><span class="code">float("23.845")</span> даст число 23.845</li>
    <li><span class="code">bool(0)</span> даст False, а от любого другого числа - True</li>
    <li><span class="code">bool("")</span> (то есть от пустой строки) даст False, а от любой другой строки - True</li>
</ul>
